-- CREATE --
CREATE TABLE STUDENT (
  absence INTEGER PRIMARY KEY,
  name TEXT NOT NULL,
  gender TEXT NOT NULL
);

CREATE TABLE VALUE (
  absence INTEGER PRIMARY KEY,
  math_value INTEGER NOT NULL,
  biology_value INTEGER NOT NULL,
  chemistry_value INTEGER NOT NULL,
  physics_value INTEGER NOT NULL
);


-- INSERT --
INSERT INTO STUDENT VALUES (01, 'Abdurrahman', 'L');
INSERT INTO STUDENT VALUES (02, 'Chairina', 'P');
INSERT INTO STUDENT VALUES (03, 'Dwi', 'P');
INSERT INTO STUDENT VALUES (04, 'Grasberg', 'L');
INSERT INTO STUDENT VALUES (05, 'Haidar', 'L');
INSERT INTO STUDENT VALUES (06, 'Hanasa', 'P');
INSERT INTO STUDENT VALUES (07, 'Izra', 'L');
INSERT INTO STUDENT VALUES (08, 'Sandi', 'L');
INSERT INTO STUDENT VALUES (09, 'Fiqriani', 'P');
INSERT INTO STUDENT VALUES (10, 'Rifqi', 'L');

INSERT INTO VALUE VALUES (01, 85, 70, 60, 90);
INSERT INTO VALUE VALUES (02, 80, 69, 87, 76);
INSERT INTO VALUE VALUES (03, 70, 80, 78, 80);
INSERT INTO VALUE VALUES (04, 95, 69, 67, 79);
INSERT INTO VALUE VALUES (05, 60, 87, 76, 81);
INSERT INTO VALUE VALUES (06, 79, 89, 86, 79);
INSERT INTO VALUE VALUES (07, 78, 75, 79, 75);
INSERT INTO VALUE VALUES (08, 90, 83, 68, 73);
INSERT INTO VALUE VALUES (09, 80, 76, 85, 79);
INSERT INTO VALUE VALUES (10, 88, 71, 88, 80);


-- AVERAGE VALUE OF EACH LESSON --

SELECT AVG(VALUE.math_value) as rata_rata_nilai_matematika
FROM VALUE

SELECT AVG(VALUE.biology_value) as rata_rata_nilai_biologi
FROM VALUE

SELECT AVG(VALUE.chemistry_value) as rata_rata_nilai_kimia
FROM VALUE

SELECT AVG(VALUE.physics_value) as rata_rata_nilai_fisika
FROM VALUE


-- STUDENTS WHO GET THE HIGHEST SCORE FOR EACH LESSON --

SELECT STUDENT.name, VALUE.math_value
FROM STUDENT
JOIN VALUE ON VALUE.absence = STUDENT.absence
ORDER BY VALUE.math_value DESC LIMIT 1

SELECT STUDENT.name, VALUE.biology_value
FROM STUDENT
JOIN VALUE ON VALUE.absence = STUDENT.absence
ORDER BY VALUE.biology_value DESC LIMIT 1

SELECT STUDENT.name, VALUE.chemistry_value
FROM STUDENT
JOIN VALUE ON VALUE.absence = STUDENT.absence
--ORDER BY VALUE.chemistry_value DESC LIMIT 1

SELECT STUDENT.name, VALUE.physics_value as 
FROM STUDENT
JOIN VALUE ON VALUE.absence = STUDENT.absence
ORDER BY VALUE.physics_value DESC LIMIT 1
